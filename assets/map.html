<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta lang="zh" />
<meta name="viewport" content="width=device-width,user-scalable=yes,initial-scale=1.0,maximum-scale=3.0" />

<title>HiTrip</title>

<link rel="stylesheet" href="js/jquery.mobile-1.3.2/jquery.mobile.theme-1.3.2.min.css">
<link rel="stylesheet" href="js/jquery.mobile-1.3.2/jquery.mobile.structure-1.3.2.min.css">
<link href="css/Map.css" rel="stylesheet">
<link href="css/Zone.css" rel="stylesheet">
<link href="css/bootstrap.css" rel="stylesheet">

<!--script type="text/javascript" src="js/cordova.js"></script-->
<script src="js/jquery-1.10.2.min.js"></script>
<script src="js/jquery.tmpl.min.js"></script>
<script src="js/Map.js"></script>
<script src="js/newThings.js"></script>
<script src="js/jingdian_introduce.js"></script>
<script src="js/Zone.js"></script>
<script src="js/jquery.mobile-1.3.2/jquery.mobile-1.3.2.min.js"></script>

<!--******************************************与拍照上传相关的代码******************************-->
	
	<!--script type="text/javascript" charset="utf-8">
    var pictureSource;  
    var destinationType; 
    document.addEventListener("deviceready",onDeviceReady,false);
    function onDeviceReady() {
	pictureSource=navigator.camera.PictureSourceType;
	destinationType=navigator.camera.DestinationType;
    }
function onPhotoURISuccess(imageURI){
	//alert("k.o!");
	var immediatePhoto = document.getElementById('immediatePhoto');
	immediatePhoto.style.display = 'block';
	immediatePhoto.src = imageURI;
	upLoadFile(imageURI);
	upLoadFile(imageURI);
}

function capturePhotoEdit(){
	window.location.href = "#photo";
//alert('ok!');
	//navigator.camera.getPicture(onPhotoURISuccess,onFail,{quality:20,allowEdit:true});
	navigator.camera.getPicture(onPhotoURISuccess,onFail,{quality:50,destinationType:destinationType.FILE_URI});
}

function getPhoto(source){
window.location.href = "#photo";
		navigator.camera.getPicture(onPhotoURISuccess,onFail,{quality:50,destinationType:destinationType.FILE_URI,sourceType:source});
}

function onFail(message){
	alert('Failed because:'+message);
}

function upLoadFile(path){
	var ft= new FileTransfer();
	ft.upload(path,"http://192.168.1.101/server/sendPhoto.php",
	function (result){
		alert('Upload success: '+result.responseCode);
	},
	function (error){
		alert('Error uploading file '+path+': '+error.code);
	},
	{fileName:'file.jpg',chunkedMode:false},true);
}

</script-->

<!--script src="https://d10ajoocuyu32n.cloudfront.net/codiqa.ext.js"></script-->

<!----------------------------------------------------- template ------------------------------------------------------>

<!----------------------添加自己到地图------------------------->
<script id='user-ego-tmpl' type='text/x-jquery-tmpl'>
	<a class="avatar"><img src=${Head}></img></a>
</script>


<!----------------------添加好友到地图------------------------->
<script id='user-friend-tmpl' type='text/x-jquery-tmpl'>
	<div class="user-friend" id=${Id}>
		<a class="avatar"><img src=${Head}></img></a>
	</div>
</script>


<!----------------------新的好友请求------------------------->
<script id="newf-tmpl" type="text/x-jquery-tmpl">
	<li id=${Id} data-corners="false" data-shadow="false" data-iconshadow="true" data-wrapperels="div" data-icon="arrow-r" data-iconpos="right" data-theme="c" class="ui-btn ui-btn-icon-right ui-li-has-arrow ui-li ui-li-has-thumb ui-first-child ui-btn-up-c">
		<div class="ui-btn-inner ui-li">
			<div class="ui-btn-text">
				<div class="ui-li-aside">
					<div data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-theme="c" data-inline="true" data-disabled="false" class="ui-btn ui-shadow ui-btn-corner-all ui-btn-inline ui-btn-up-c" aria-disabled="false">
						<span class="ui-btn-inner">
							<span class="ui-btn-text">同意</span>
						</span>
						<button class="newfY ui-btn-hidden" data-inline="true" data-disabled="false">同意</button>
					</div>
					<div data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-theme="c" data-inline="true" data-disabled="false" class="ui-btn ui-shadow ui-btn-corner-all ui-btn-inline ui-btn-up-c" aria-disabled="false">
						<span class="ui-btn-inner">
							<span class="ui-btn-text">拒绝</span>
						</span>
						<button class="newfN ui-btn-hidden" data-inline="true" data-disabled="false">拒绝</button>
					</div>
				</div>
				<a href="#zone-others" class="ui-link-inherit">
					<img src=${Head} class="ui-li-thumb">
					<h3 class="ui-li-heading">${Name}</h3><p class="ui-li-desc">请求加您为好友</p>
				</a>
			</div>
			<span class="ui-icon ui-icon-arrow-r ui-icon-shadow">&nbsp;</span>
		</div>
	</li>
</script>


<!----------------------好友请求被接受------------------------->
<script id="newf-accept-tmpl" type="text/x-jquery-tmpl">
	<li>
		<a href="#zone-others">
			<img src=${Head}/>
			<h3>王小明</h3><p>已添加您为好友</p>
		</a>
	</li>
</script>


<!----------------------添加好友文字状态到地图----------------------->
<script id="status-word-tmpl" type="text/x-jquery-tmpl">
	<a class="bubble"><div class="tooltip fade right in bubble-word">
		<div class="tooltip-arrow"></div>
		<div class="tooltip-inner">${Content}</div>
	</div></a>
</script>


<!----------------------添加好友图片状态到地图----------------------->
<script id="status-pic-tmpl" type="text/x-jquery-tmpl">
	<a class="bubble"><div class="tooltip fade right in bubble-img">
		<div class="tooltip-arrow"></div>
		<div class="tooltip-inner"><img src=${Picture}></div>
	</div></a>
</script>


<!----------------------添加景点文字状态到地图----------------------->
<script id="spot-word-tmpl" type="text/x-jquery-tmpl">
	<a class="bubble"><div class="tooltip fade right in mb-word">
		<div class="tooltip-arrow"></div>
		<div class="tooltip-inner">${Content}</div>
	</div></a>
</script>


<!----------------------添加景点图片状态到地图----------------------->
<script id="spot-pic-tmpl" type="text/x-jquery-tmpl">
	<a class="bubble"><div class="tooltip fade right in mb-img">
		<div class="tooltip-arrow"></div>
		<div class="tooltip-inner">
			<img src=${Picture}>
			${Content}
		</div>
	</div></a>
</script>



<!----------------------文字状态(无回复)----------------------->
<script id='text_status_no_reply_button'  type='text/x-jquery-tmpl'>
	<tr><td><img src=${Head} width="50px" height="50px"/></td><td style="text-align:left">${Name}</td></tr>
	<tr><td></td><tdstyle="text-align:left">${Content}<br /></td></tr>
</script>



<!----------------------图片状态(无回复)---------------------->
<script id='pic_status_no_reply_button'  type='text/x-jquery-tmpl'>
	<tr><td><img src=${Head} width="50px" height="50px"/></td><td style="text-align:left">${Name}</td></tr>
	<tr><td></td><td style="text-align:left"><img src=${IMG} width="100%" /><br/>${Content}</br></td></tr>
</script>


<!---------------------------回复---------------------------->
<script id='reply-tmpl' type='text/x-jquery-tmpl'>
	<tr>
		<td></td><td id=${Id}><div id=${Reply_id} style="text-align:left"><img src=${Head} width="30px" height="30px"/>${Name} 回复${Target_Name}: ${Content}<a class="button-reply" ><img width="20px" height="20px" src="img/reply.png" style="float:right"/></a></div></td>
	</tr>
</script>


<!----------------------文字状态(有回复)----------------------->
<script id='text_status_reply_button'  type='text/x-jquery-tmpl'>
	<tr><td><img src=${Head} width="50px" height="50px"/></td><td style="text-align:left">${Name}</td></tr>
	<tr><td></td><td id=${Id}><div id=${Entry_id} style="text-align:left">${Content}<a class="status-button-reply"><img width="20px" height="20px" src="img/reply.png" style="float:right"/></a></div></td></tr>
</script>


<!----------------------图片状态(有回复)---------------------->
<script id='pic_status_reply_button'  type='text/x-jquery-tmpl'>
	<tr><td><img src=${Head} width="50px" height="50px"/></td><td style="text-align:left">${Name}</td></tr>
	<tr><td></td><td><img src=${IMG} width="100%" /></td></tr>
	<tr><td></td><td id=${Id}><div id=${Entry_id} style="text-align:left">${Content}<a class="status-button-reply"><img width="20px" height="20px" src="img/reply.png" style="float:right"/></a></div></td></tr>
</script>



<!----------------------------足迹----------------------------->
<script id="footprint-tmpl" type="text/x-jquery-tmpl">
	<img class="footprint" src="img/footprint.png" style="top:${top}px;left:${left}px";/>
</script>

<!--------------------------景点介绍-------------------------->
	<script id='jingdianImg1'  type='text/x-jquery-tmpl'>
		<tr><td><img src=${portrait} width="50px" height="50px"/></td><td>${evaluator_name}</td></tr>
		<tr><td></td><td>${content}<br /></td><td><img src="img/1star.gif"></td></tr>
	</script>
	<script id='jingdianImg2'  type='text/x-jquery-tmpl'>
		<tr><td><img src=${portrait} width="50px" height="50px"/></td><td>${evaluator_name}</td></tr>
		<tr><td></td><td>${content}<br /></td><td><img src="img/2star.gif"></td></tr>
	</script>
	<script id='jingdianImg3'  type='text/x-jquery-tmpl'>
		<tr><td><img src=${portrait} width="50px" height="50px"/></td><td>${evaluator_name}</td></tr>
		<tr><td></td><td>${content}<br /></td><td><img src="img/3star.gif"></td></tr>
	</script>
	<script id='jingdianImg4'  type='text/x-jquery-tmpl'>
		<tr><td><img src=${portrait} width="50px" height="50px"/></td><td>${evaluator_name}</td></tr>
		<tr><td></td><td>${content}<br /></td><td><img src="img/4star.gif"></td></tr>
	</script>
	<script id='jingdianImg5'  type='text/x-jquery-tmpl'>
		<tr><td><img src=${portrait} width="50px" height="50px"/></td><td>${evaluator_name}</td></tr>
		<tr><td></td><td>${content}<br /></td><td><img src="img/5star.gif"></td></tr>
	</script>
	<script id='newThing' type='text/x-jquery-tmpl'>
		<tr><td>${Content}</td></tr>
	</script>
	<script id='newThingImg'  type='text/x-jquery-tmpl'>
		<tr><td><img src=${IMG} width="300px" height="300px"/></td></tr>
		<tr><td>${Content}</td></tr>
	</script>

<!---------------------------------------------------------后台--------------------------------------------------------->
<script>
/********************全局变量********************/
var sendLocationIntervalId;
var queryAnswerId;
var queryAnswerCount=0;
var queryFriendsId;
var queryMessageId;
var queryJingdianNewsId;

/********************初始调用********************/
function init(){

	//getSelfInfo(); 
	//getFriendInfo();
	myListener();
	showMyPosition(31.88736,118.83043);
	//foot_print();
	//queryMessageId=setInterval(queryMessage,1000);
	//sendLocationIntervalId = setInterval(sendLocation,1000);
	//queryFriendsId = setInterval(queryFriends,1000);
	//queryJingdianNewsId=setInterval(queryJingdianNews,1000);
	//aaa();
	
}

/********************显示足迹********************/
function foot_print(){
	var json_footprint=[{"top":"100","left":"100"},
						{"top":"100","left":"200"},
						{"top":"100","left":"300"},
						{"top":"100","left":"400"}];
	var footIntervalId = setInterval(foot,1000);
	var i=0;
	function foot(){
		if(i>=json_footprint.length)
			clearInterval(footIntervalId);
		else
			$("#footprint-tmpl").tmpl(json_footprint[i++]).appendTo("#map-sketch");
	}
}	

/********************添加景点关注********************/
function eyeOn(idName){
	//var jingdian_id=6;//要作为参数传入
	var xmlHttp;
	if(window.ActiveXObject){
		xmlHttp = new ActiveXObject("Microsoft.XMLHttp");
	}else if(window.XMLHttpRequest){
		xmlHttp = new XMLHttpRequest();
	}
    var param ="idName="+idName+"&t="+Math.random();
		console.log(param);
	var url = "http://192.168.1.101/server/eyeOn.php";
	xmlHttp.onreadystatechange = function(){
		if(xmlHttp.readyState==4){
		if(xmlHttp.status == 200){
			var test = xmlHttp.responseText;
			console.log("From:eyeOn.php:");
			console.log(test);
			}
		}
	};
	xmlHttp.open("POST",url);
	xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
	xmlHttp.send(param);
}

/********************实时查找景点消息********************/
function queryJingdianNews(){
	var xmlHttp;
	if(window.ActiveXObject){
		xmlHttp = new ActiveXObject("Microsoft.XMLHttp");
	}else if(window.XMLHttpRequest){
		xmlHttp = new XMLHttpRequest();
	}
    var param ="t="+Math.random();
	var url = "http://192.168.1.101/server/queryJingdianNews.php";
	xmlHttp.onreadystatechange = function(){
		if(xmlHttp.readyState == 4){
		if(xmlHttp.status == 200){
			var test = xmlHttp.responseText;
			console.log("From:queryJingdianNews.php:");
			console.log(test);
			if(test=="1"){
				console.log("没有新消息！");
			}
			else{
				var news = eval("("+test+")");//形如下面的JSON数组：
				//[{"Id":"1","Head":"","Name":"\u7126\u5ef7\u6807\u9986","Picture":"jj","Content":"\u5feb\u4e50\u7684\u8682\u86b1"}] 
				for(var i=0;i<news.length;i++){
					var id=news[i].IdName;
					var pic=news[i].Picture;
					if(pic==""){
						$("#spot-word-tmpl").tmpl(news[i]).appendTo("#"+id);
					}else{
						$("#spot-pic-tmpl").tmpl(news[i]).appendTo("#"+id);
					}
				}
			}
			}
		}
	};
	xmlHttp.open("POST",url);
	xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
	xmlHttp.send(param);
}

/********************地图消息发送和请求好友消息，发布文字状态********************/
function sendMessage(){
	var content = $("#message").val();
	var xmlHttp;
	if(window.ActiveXObject){
		xmlHttp = new ActiveXObject("Microsoft.XMLHttp");
	}else if(window.XMLHttpRequest){
		xmlHttp = new XMLHttpRequest();
	}
    var param ="content="+content+"&t="+Math.random();
		console.log(param);
	var url = "http://192.168.1.101/server/sendMessage.php";
	xmlHttp.onreadystatechange = function(){
		if(xmlHttp.readyState == 4){
		if(xmlHttp.status == 200){
			var test = xmlHttp.responseText;
			console.log("From:sendMessage.php:");
			console.log(test);
			if(test!="0"){
			//var answer = eval("("+test+")");
			alert("消息发送失败！");
			}
			}
		}
	};
	xmlHttp.open("POST",url);
	xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
	xmlHttp.send(param);
}

/********************地图消息发送和请求好友消息，发布图片状态********************/
function sendMessage2(){
	var content = $("#message2").val();
	$("#message2").empty();
	var xmlHttp;
	if(window.ActiveXObject){
		xmlHttp = new ActiveXObject("Microsoft.XMLHttp");
	}else if(window.XMLHttpRequest){
		xmlHttp = new XMLHttpRequest();
	}
    var param ="content="+content+"&t="+Math.random();
		console.log(param);
	var url = "http://192.168.1.101/server/sendMessage.php";
	xmlHttp.onreadystatechange = function(){
		if(xmlHttp.readyState == 4){
		if(xmlHttp.status == 200){
			var test = xmlHttp.responseText;
			console.log("From:sendMessage.php:");
			console.log(test);
			if(test!="0"){
			//var answer = eval("("+test+")");
			alert("消息发送失败！");
			}
			}
		}
	};
	xmlHttp.open("POST",url);
	xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
	xmlHttp.send(param);
}

/********************实时查询好友发布的状态********************/
function queryMessage(){//need to be added into init()
	var xmlHttp;
	if(window.ActiveXObject){
		xmlHttp = new ActiveXObject("Microsoft.XMLHttp");
	}else if(window.XMLHttpRequest){
		xmlHttp = new XMLHttpRequest();
	}
    var param ="t="+Math.random();
		console.log(param);
	var url = "http://192.168.1.101/server/queryMessage.php";
	xmlHttp.onreadystatechange = function(){
		if(xmlHttp.readyState == 4){
		if(xmlHttp.status == 200){
			var test = xmlHttp.responseText;
			console.log("From:queryMessage.php:");
			console.log(test);
			if(test=="1"){
				console.log("没有新消息！");
			}
			else{
				var news = eval("("+test+")");//形如下面的JSON数组：
				//[{"Longitude":"0","Latitude":"0","Head":"http:\/\/192.168.1.101\/register8.24\/files\/D.jpg","Id":"4","Name":"D","Picture":"","Content":"\u7537\u4eba\u5c31\u662f\u7d2f\uff01"},{"Longitude":"0","Latitude":"0","Head":"http:\/\/192.168.1.101\/register8.24\/files\/D.jpg","Id":"4","Name":"D","Picture":"","Content":"\u7537\u4eba\u5c31\u662f\u7d2f\uff01"},{"Longitude":"0","Latitude":"0","Head":"http:\/\/192.168.1.101\/register8.24\/files\/D.jpg","Id":"4","Name":"D","Picture":"","Content":"\u7537\u4eba\u5c31\u662f\u7d2f\uff01"},{"Longitude":"0","Latitude":"0","Head":"http:\/\/192.168.1.101\/register8.24\/files\/C.jpg","Id":"3","Name":"C","Picture":"","Content":"\u7537\u4eba\u5c31\u662f\u7d2f\uff01"},{"Longitude":"0","Latitude":"0","Head":"http:\/\/192.168.1.101\/register8.24\/files\/D.jpg","Id":"4","Name":"D","Picture":"","Content":"\u7537\u4eba\u5c31\u662f\u7d2f\uff01"},{"Longitude":"0","Latitude":"0","Head":"http:\/\/192.168.1.101\/register8.24\/files\/D.jpg","Id":"4","Name":"D","Picture":"","Content":"\u7537\u4eba\u5c31\u662f\u7d2f\uff01"},{"Longitude":"0","Latitude":"0","Head":"http:\/\/192.168.1.101\/register8.24\/files\/D.jpg","Id":"4","Name":"D","Picture":"","Content":"\u7537\u4eba\u5c31\u662f\u7d2f\uff01"}]
				for(var i=0;i<news.length;i++){
					var id=news[i].Id;
					var pic=news[i].Picture;
					if(pic==""){
						$("#status-word-tmpl").tmpl(news[i]).appendTo("#"+id);
					}else{
						$("#status-pic-tmpl").tmpl(news[i]).appendTo("#"+id);
					}
				}
			}
			}
		}
	};
	xmlHttp.open("POST",url);
	xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
	xmlHttp.send(param);
}

/********************添加自己到地图********************/
function getSelfInfo(){
	var xmlHttp;
	if(window.ActiveXObject){
		xmlHttp = new ActiveXObject("Microsoft.XMLHttp");
	}else if(window.XMLHttpRequest){
		xmlHttp = new XMLHttpRequest();
	}
    var param ="t="+Math.random();
		console.log(param);
	var url = "http://192.168.1.101/server/getSelfInfo.php";
	xmlHttp.onreadystatechange = function(){
		if(xmlHttp.readyState==4){
		if(xmlHttp.status == 200){
			var test = xmlHttp.responseText;
			//alert("QQQ: "+test);
			var selfInfo = eval("("+test+")");
			$("#user-ego-tmpl").tmpl(selfInfo).appendTo("#user-ego");
			console.log("From:getSelfInfo.php:");
			console.log(test);
			}
		}
	};
	xmlHttp.open("POST",url);
	xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
	xmlHttp.send(param);
}

/********************添加好友到地图********************/
function getFriendInfo(){
	var xmlHttp;
	if(window.ActiveXObject){
		xmlHttp = new ActiveXObject("Microsoft.XMLHttp");
	}else if(window.XMLHttpRequest){
		xmlHttp = new XMLHttpRequest();
	}
    var param ="t="+Math.random();
		console.log(param);
	var url = "http://192.168.1.101/server/getFriendInfo.php";
	xmlHttp.onreadystatechange = function(){
		if(xmlHttp.readyState==4){
		if(xmlHttp.status == 200){
			var test = xmlHttp.responseText;
			var friends = eval("("+test+")");
			var flag=0;
			if(flag==0){
				for(var i=0;i<friends.length;i++){
					$("#user-friend-tmpl").tmpl(friends[i]).appendTo("#map-sketch");
				}
				flag=1;
			}
			for(var i=0;i<friends.length;i++){
				showAllPosition(friends[i].Latitude,friends[i].Longitude,friends[i].Id);
			}
			console.log("From:getFriendInfo.php:");
			console.log(test);
			console.log(friends[0].Name);
		}
		}
	};
	xmlHttp.open("POST",url);
	xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
	xmlHttp.send(param);
}

/********************添加驴友到地图********************/
function getStrangeInfo(){
	var xmlHttp;
	if(window.ActiveXObject){
		xmlHttp = new ActiveXObject("Microsoft.XMLHttp");
	}else if(window.XMLHttpRequest){
		xmlHttp = new XMLHttpRequest();
	}
    var param ="t="+Math.random();
		console.log(param);
	var url = "http://192.168.1.101/server/getStrangeInfo.php";
	xmlHttp.onreadystatechange = function(){
		if(xmlHttp.readyState==4){
		if(xmlHttp.status == 200){
			var test = xmlHttp.responseText;
			var strange = eval("("+test+")");
			//此处动态添加div
			console.log("From:getStrangeInfo.php:");
			console.log(test);
			console.log(strange[0].Name);
		}
		}
	};
	xmlHttp.open("POST",url);
	xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
	xmlHttp.send(param);
}

/*********************发送好友请求***********************/
function requestFriends(targetId){
//alert("!");
	if(queryAnswerCount==0){
		queryAnswerId = setInterval("queryAnswer()",1000);		
	}
	queryAnswerCount++;
	//var targetId=6;
	var xmlHttp;
	if(window.ActiveXObject){
		xmlHttp = new ActiveXObject("Microsoft.XMLHttp");
	}else if(window.XMLHttpRequest){
		xmlHttp = new XMLHttpRequest();
	}
    var param ="targetId="+targetId+"&t="+Math.random();
		console.log(param);
	var url = "http://192.168.1.101/server/requestFriends.php";
	xmlHttp.onreadystatechange = function(){
		if(xmlHttp.readyState==4){
		if(xmlHttp.status == 200){
			var test = xmlHttp.responseText;
			console.log("From:requestFriends.php:");
			console.log(test);
			}
		}
	};
	xmlHttp.open("POST",url);
	xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
	xmlHttp.send(param);
}

/*******用户登录成功后调用，查询是否有新的好友请求，返回请求该用户的JSON数组*******/
function queryFriends(){
	var xmlHttp;
	if(window.ActiveXObject){
		xmlHttp = new ActiveXObject("Microsoft.XMLHttp");
	}else if(window.XMLHttpRequest){
		xmlHttp = new XMLHttpRequest();
	}
    var param ="t="+Math.random();
		console.log(param);
	var url = "http://192.168.1.101/server/queryFriends.php";
	xmlHttp.onreadystatechange = function(){
		if(xmlHttp.readyState==4){
		if(xmlHttp.status == 200){
			var test = xmlHttp.responseText;
			console.log("From:queryFriends.php:");
			console.log(test);
			if(test==-1){
				alert("Update 失败！");
			}else{
			if(test!="1"){
				var strange = eval("("+test+")");
				for(var i=0;i<strange.length;i++){
					$("#newf-tmpl").tmpl(strange[i]).prependTo("#newf-list");
					//alert(i)
				}	
					myListener();

			}else{
			test = "没有人请求添加我为好友";
			}
			}
			
			}
		}
	};
	xmlHttp.open("POST",url);
	xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
	xmlHttp.send(param);
}

/*****************是否接受好友请求*****************/
function answerFriends(answer,answerUserId){
	//answer,1表示接受好友请求，2表示拒绝
	//answerUserId表示回复的用户的Id，应作为参数传入
	var xmlHttp;
	if(window.ActiveXObject){
		xmlHttp = new ActiveXObject("Microsoft.XMLHttp");
	}else if(window.XMLHttpRequest){
		xmlHttp = new XMLHttpRequest();
	}
    var param ="answer="+answer+"&answerUserId="+answerUserId+"&t="+Math.random();
		console.log(param);
	var url = "http://192.168.1.101/server/answerFriends.php";
	xmlHttp.onreadystatechange = function(){
		if(xmlHttp.readyState == 4){
		if(xmlHttp.status == 200){
			var test = xmlHttp.responseText;
			console.log("From:answerFriends.php:");
			console.log(test);
			}
		}
	};
	xmlHttp.open("POST",url);
	xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
	xmlHttp.send(param);	
}

/**查询对方是否给出回复，如果给出返回值是对方信息的json变量和回复的status，1表示同意，0表示不统一**/
function queryAnswer(){
	var xmlHttp;
	if(window.ActiveXObject){
		xmlHttp = new ActiveXObject("Microsoft.XMLHttp");
	}else if(window.XMLHttpRequest){
		xmlHttp = new XMLHttpRequest();
	}
    var param ="t="+Math.random();
		console.log(param);
	var url = "http://192.168.1.101/server/queryAnswer.php";
	xmlHttp.onreadystatechange = function(){
		if(xmlHttp.readyState == 4){
		if(xmlHttp.status == 200){
			var test = xmlHttp.responseText;
			console.log("From:queryAnswer.php:");
			console.log(test);
			if(test!=""){
				var answer = eval("("+test+")");//得到了对方的JSON变量和结果
				for(var i=0;i<answer.length;i++){
					if(answer[i].status==1){
						$("#newf-accept-tmpl").tmpl(answer[i]).prependTo("#newf-list");
					}
				}
				queryAnswerCount-=answer.length;
				if(queryAnswerCount==0)//表示所有的请求都得到了回答
				clearInterval(queryAnswerId);//终止此次查找
			}			
			}
		}
	};
	xmlHttp.open("POST",url);
	xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
	xmlHttp.send(param);
}

/*****************每次动态添加都要调用一次函数以执行JQuery效果*********************/
var flag_zone_eyeon=0;
var flag_spot_eyeon=0;
function myListener(){
	$(document).ready(function(){
	   $(".newfY").tap(function(){
			var id=$(this).parent().parent().parent().parent().parent().attr("id");
			$("#"+id).find(".ui-li-aside").empty();
			$("#"+id).find(".ui-li-aside").append("<div data-corners='true' data-shadow='true' data-iconshadow='true' data-wrapperels='span' data-theme='c' data-inline='true' data-disabled='false' class='ui-btn ui-shadow ui-btn-corner-all ui-btn-inline ui-btn-up-c' aria-disabled='false'><span class='ui-btn-inner'><span class='ui-btn-text'>已添加</span></span><button data-inline='true' class='ui-btn-hidden' data-disabled='false'>已添加</button></div>");
			answerFriends(1,id);
		});
		$(".newfN").tap(function(){
			var id=$(this).parent().parent().parent().parent().parent().attr("id");
			$("#"+id).find(".ui-li-aside").empty();
			$("#"+id).find(".ui-li-aside").append("<div data-corners='true' data-shadow='true' data-iconshadow='true' data-wrapperels='span' data-theme='c' data-inline='true' data-disabled='false' class='ui-btn ui-shadow ui-btn-corner-all ui-btn-inline ui-btn-up-c' aria-disabled='false'><span class='ui-btn-inner'><span class='ui-btn-text'>已拒绝</span></span><button data-inline='true' class='ui-btn-hidden' data-disabled='false'>已拒绝</button></div>");
			answerFriends(2,id);
		});
		$(".eyeon").tap(function(){
			var id=$(this).parent().parent().parent().attr("id");
			$(".zone-eyeon").empty();
			if(flag_zone_eyeon==0){
				$(".zone-eyeon").append("<a class='eyeon ui-btn ui-shadow ui-btn-corner-all ui-mini ui-btn-inline ui-btn-icon-left ui-btn-up-c' href='#' data-role='button' data-theme='c' data-icon='minus' data-inline='true' data-mini='true' data-corners='true' data-shadow='true' data-iconshadow='true' data-wrapperels='span'><span class='ui-btn-inner'><span class='ui-btn-text'>取消关注</span><span class='ui-icon ui-icon-minus ui-icon-shadow'>&nbsp;</span></span></a>");
				flag_zone_eyeon=1;
				myListener();
			}else{
				$(".zone-eyeon").append("<a class='eyeon ui-btn ui-btn-up-e ui-shadow ui-btn-corner-all ui-mini ui-btn-inline ui-btn-icon-left' href='#' data-role='button' data-theme='e' data-icon='plus' data-inline='true' data-mini='true' data-corners='true' data-shadow='true' data-iconshadow='true' data-wrapperels='span'><span class='ui-btn-inner'><span class='ui-btn-text'>加关注</span><span class='ui-icon ui-icon-plus ui-icon-shadow'>&nbsp;</span></span></a>");
				flag_zone_eyeon=0;
				myListener();
			}
			requestFriends(id);
		});
		$(".eyeon-spot").tap(function(){
			var id=$(this).parent().parent().parent().attr("id");
			$(".spot-eyeon").empty();
			if(flag_spot_eyeon==0){
				$(".spot-eyeon").append("<div data-corners='true' data-shadow='true' data-iconshadow='true' data-wrapperels='span' data-icon='minus' data-theme='c' data-inline='true' data-disabled='false' class='ui-btn ui-shadow ui-btn-corner-all ui-btn-inline ui-btn-icon-left ui-btn-hover-c ui-btn-up-c' aria-disabled='false'><span class='ui-btn-inner'><span class='ui-btn-text'>取消关注</span><span class='ui-icon ui-icon-minus ui-icon-shadow'>&nbsp;</span></span><button class='eyeon-spot ui-btn-hidden' data-inline='true' data-icon='minus' data-disabled='false'>取消关注</button></div>");
				flag_spot_eyeon=1;myListener();
			}else{
				$(".spot-eyeon").append("<div data-corners='true' data-shadow='true' data-iconshadow='true' data-wrapperels='span' data-icon='plus' data-theme='c' data-inline='true' data-disabled='false' class='ui-btn ui-shadow ui-btn-corner-all ui-btn-inline ui-btn-icon-left ui-btn-up-c' aria-disabled='false'><span class='ui-btn-inner'><span class='ui-btn-text'>加关注</span><span class='ui-icon ui-icon-plus ui-icon-shadow'>&nbsp;</span></span><button class='eyeon-spot ui-btn-hidden' data-inline='true' data-icon='plus' data-disabled='false'>加关注</button></div>");
				flag_spot_eyeon=0;myListener();
			}
			eyeOn(id);
		});
  	});
}

/*****************测试函数，用以添加新的好友请求信息********************/
function aaa(){
	var json1=[{"Longitude":"118.8136401","Latitude":"31.885700300000003","Head":"http:\/\/localhost\/register8.24\/files\/A.jpg","Id":"1","Name":"A"}];
	for(var i=0;i<json1.length;i++){
		$("#newf-tmpl").tmpl(json1[i]).prependTo("#newf-list");
	}
	myListener();
	var json2=[{"Longitude":"0","Latitude":"0","Head":"http:\/\/192.168.1.101\/register8.24\/files\/D.jpg","Id":"4","Name":"D","Picture":"","Content":"\u7537\u4eba\u5c31\u662f\u7d2f\uff01"},{"Longitude":"0","Latitude":"0","Head":"http:\/\/192.168.1.101\/register8.24\/files\/D.jpg","Id":"4","Name":"D","Picture":"","Content":"\u7537\u4eba\u5c31\u662f\u7d2f\uff01"},{"Longitude":"0","Latitude":"0","Head":"http:\/\/192.168.1.101\/register8.24\/files\/D.jpg","Id":"4","Name":"D","Picture":"","Content":"\u7537\u4eba\u5c31\u662f\u7d2f\uff01"},{"Longitude":"0","Latitude":"0","Head":"http:\/\/192.168.1.101\/register8.24\/files\/C.jpg","Id":"3","Name":"C","Picture":"","Content":"\u7537\u4eba\u5c31\u662f\u7d2f\uff01"},{"Longitude":"0","Latitude":"0","Head":"http:\/\/192.168.1.101\/register8.24\/files\/D.jpg","Id":"4","Name":"D","Picture":"","Content":"\u7537\u4eba\u5c31\u662f\u7d2f\uff01"},{"Longitude":"0","Latitude":"0","Head":"http:\/\/192.168.1.101\/register8.24\/files\/D.jpg","Id":"4","Name":"D","Picture":"","Content":"\u7537\u4eba\u5c31\u662f\u7d2f\uff01"},{"Longitude":"0","Latitude":"0","Head":"http:\/\/192.168.1.101\/register8.24\/files\/D.jpg","Id":"4","Name":"D","Picture":"","Content":"\u7537\u4eba\u5c31\u662f\u7d2f\uff01"}]
	for(var i=0;i<json2.length;i++){
					var id=json2[i].Id;
					var pic=json2[i].Picture;
					if(pic==""){
						$("#status-word-tmpl").tmpl(json2[i]).appendTo("#"+id);
					}else{
						$("#status-pic-tmpl").tmpl(json2[i]).appendTo("#"+id);
					}
				}
}
</script>

</head>

<body style="font-family:微软雅黑;padding:0;" onload="init()">

<div data-role="page" id="page0" data-theme="c" >
    <div data-role="header" data-theme="c">
      <h1>首页</h1>
      <a href="#panel0" data-icon="bars" data-iconpos="notext" data-shadow="false" data-iconshadow="false">Menu</a>
    </div>
    <div data-role="content" style="padding: 0%">
		<div>
			<div id="googlemapsjs3" class="google-map" style="width: 480px; height: 400px;">
			</div>
			<script type="text/javascript">
			window.CodiqaControls && window.CodiqaControls.register('googlemaps', 'googlemapsjs3', {
				ready: function(control) {
					control.options = {
						zoom: 14,
						mapTypeId: google.maps.MapTypeId.ROADMAP
					};

					control.el = document.getElementById(control._id);
					control.map = new google.maps.Map(control.el, control.options);

					var geocoder = new google.maps.Geocoder();
					geocoder.geocode({'address': 'Nanjing，China'}, function(results, status) {
						if (status == google.maps.GeocoderStatus.OK) {
							var marker = new google.maps.Marker({
								map: control.map,
								position: results[0].geometry.location
							});
							control.center = results[0].geometry.location;
							control.map.setCenter(control.center);
						}
					});
				}
			});
			</script>
        </div>
    </div>
    <div data-role="panel" id="panel0" data-theme="b" data-position-fixed="true">
		<ul data-role="listview" data-divider-theme="b" data-inset="false">
			<li data-theme="a" id="panelHead"><img id="panelHeadImg" src="img/Avatar.jpg" height="100%">王小明</li>
			<li data-theme="c"><a href="#panel0" data-transition="flip" >首页</a></li>
			<li data-theme="c"><a href="#page1" >景区地图</a></li>
			<li data-role="list-divider" >动态</li>
			<li data-theme="c"><a href="#page2" data-transition="flip">好友动态</a></li>
			<li data-theme="c"><a href="#page3" data-transition="flip">	景区新鲜事</a></li>
			<li data-role="list-divider">关于我</li>
			<li data-theme="c"><a href="#page4" data-transition="flip" >个人主页</a></li>
			<li data-theme="c"><a href="#msg-reply" data-transition="flip">消息中心</a></li>
			<li data-role="list-divider">操作</li>
			<li data-theme="c"><a href="#page5" data-transition="flip">设置</a></li>
			<li data-theme="c"><a>注销</a></li>
		</ul>
    </div>
</div> 
  

 
<!-------------------------------------------------------景区地图--------------------------------------------------------->
<div data-role="page" id="page1" data-theme="c" >
    <div data-role="header" data-theme="c" id="header">
      <h1>景区地图</h1>
      <a href="#panel1" data-icon="bars" data-iconpos="notext" data-shadow="false" data-iconshadow="false">Menu</a>
    </div>
	<div data-role="content" style="padding:0%;" id="minilayer" class="minilayer" >
		<div class="map-sketch" id="map-sketch">
						
			<!-------------------景点标注------------------->
			<div class="marker" id="jtbg">
				<a class="pin"><img src="img/Marker-BB.png"/></a>
				<a class="bubble-name" href="#introduce"><div class="tooltip fade top in">
					<div class="tooltip-arrow"></div>
					<div class="tooltip-inner">焦廷标馆</div>
				</div></a>
				<!--a class="bubble"><div class="tooltip fade right in mb-img">
					<div class="tooltip-arrow"></div>
					<div class="tooltip-inner">
						<img src="img/female.png">
						啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊
					</div>
				</div></a-->
			</div>
			<div class="marker" id="lwz">
				<a class="pin"><img src="img/Marker-GB.png"/><a>
				<a class="bubble-name" href="#introduce"><div class="tooltip fade top in">
					<div class="tooltip-arrow"></div>
					<div class="tooltip-inner">李文正图书馆</div>
				</div></a>
				<!--a class="bubble"><div class="tooltip fade right in mb-word">
					<div class="tooltip-arrow"></div>
					<div class="tooltip-inner">
						啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊
					</div>
				</div></a-->
			</div>
			<div class="marker" id="jsjl">
				<a class="pin"><img src="img/Marker-WG.png"/></a>
				<a class="bubble-name" href="#introduce"><div class="tooltip fade top in">
					<div class="tooltip-arrow"></div>
					<div class="tooltip-inner">计算机 / 软件楼</div>
				</div></a>
			</div>
			<div class="marker" id="jzl">
				<a class="pin"><img src="img/Marker-WP.png"/></a>
				<a class="bubble-name" href="#introduce"><div class="tooltip fade top in">
					<div class="tooltip-arrow"></div>
					<div class="tooltip-inner">金智楼</div>
				</div></a>
			</div>
			
			<!-------------------用户头像和状态显示--------------------->
			<div class="user-ego" id="user-ego">
				<a class="avatar"><img src="img/Avatar.jpg"></img></a>
			</div>
			<div class="user-friend" id="3" style="top:1000px;left:1000px;">
				<a class="avatar"><img src="img/Avatar.jpg"></img></a>
				<a class="bubble" href="#status"><div class="tooltip fade right in bubble-img">
					<div class="tooltip-arrow"></div>
					<div class="tooltip-inner"><img src="img/Avatar.jpg"></div>
				</div></a>
			</div>
			<div class="user-friend" style="top:100px;left:500px;">
				<a class="avatar"><img src="img/Avatar.jpg"></img></a>
				<a class="bubble"><div class="tooltip fade right in bubble-word">
					<div class="tooltip-arrow"></div>
					<div class="tooltip-inner">啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊</div>
				</div></a>
			</div>
		</div>
				
		<!----------------------进度条------------------------>
		<div class="progress progress-warning active progress-striped" id="progress">
			<div class="bar" id="bar" style="width: 0;"></div>
			<p style="position:absolute;margin-left:48.5%;font-size:23px;padding-top:0.4%"><span id="count">0</span>/10</p>
		</div>
		
		<!---------------------地图切换--------------------->
		<!--div class="" id="switch-button">
			<a onclick="capturePhotoEdit();"><img src="img/Photo.png"/></a>
		</div>
		<div class="" id="switch-list">
			<ul data-role="listview">
				<li><a href="" id="simple-map">普通地图</a></li>
				<li><a href="" id="friend-map">好友地图</a></li>
				<li><a href="" id="stranger-map">驴友地图</a></li>
			</ul>
		</div-->
		<a id="switch-button" href="#popupPanel" data-rel="popup" data-transition="pop" data-position-to="window">
			<img src="img/switch-button.png"/>
		</a> 
		<div data-role="popup" id="popupPanel" data-corners="false" data-theme="none" data-shadow="false" data-tolerance="0,0">
			<button data-theme="a" data-mini="true" id="simple-map">普通地图</button>
			<button data-theme="a" data-mini="true" id="friend-map">好友地图</button>
			<button data-theme="a" data-mini="true" id="stranger-map">驴友地图</button>
		</div>
		
		<!---------------------照相按钮--------------------->
		<div id="photo-button">
			<a><img src="img/Photo.png"/></a>
		</div>
		<div id="pub-bar">
			<a href="#pub" data-transition="slide"  id="pub-bar-status" style="display:inline-block;height:50px;"><i class="icon-edit"></i>状态</a> |
			<a id="pub-bar-camera" onclick="capturePhotoEdit();" style="display:inline-block;height:50px;"><i class="icon-camera"></i>拍照</a> |
			<a id="pub-bar-gallery" onclick="getPhoto(pictureSource.PHOTOLIBRARY);" style="display:inline-block;height:50px;"><i class="icon-picture"></i>图库</a>
		</div>
		
		<!----------------------定位到我---------------------->
		<div id="pinpoint-button">
			<img src="img/pinpoint-me.png"/>
		</div>		
		
		<!---------------------景点盖章--------------------->
		<div id="box">
			<img class="seal" src="img/bind.jpg" id="bind"/>
			<img class="seal" src="img/badge.jpg" id="badge"/>
			<img class="seal" src="img/star-fill.jpg" id="star-fill"/>
			<img class="seal" src="img/star-twinkle.jpg" id="star-twinkle"/>
		</div>
		
		
	</div>
	
	<!---------------------景区地图panel--------------------->
	<div data-role="panel" id="panel1" data-theme="b" data-position-fixed="true">
		<ul data-role="listview" data-divider-theme="b" data-inset="false">
			<li data-theme="a" id="panelHead"><img id="panelHeadImg" src="img/Avatar.jpg" height="100%">王小明</li>
			<li data-theme="c"><a href="#page0" data-transition="flip" >首页</a></li>
			<li data-theme="c"><a href="#panel1" >景区地图</a></li>
			<li data-role="list-divider" >动态</li>
			<li data-theme="c"><a href="#page2" data-transition="flip" onclick="initialFriendStatus()">好友动态</a></li>
			<li data-theme="c"><a href="#page3" data-transition="flip" onclick="initialQueryJDNews()">景区新鲜事</a></li>
			<li data-role="list-divider">关于我</li>
			<li data-theme="c"><a href="#page4" data-transition="flip" onclick="initialQueryPersonNews()">个人主页</a></li>
			<li data-theme="c"><a href="#msg-reply" data-transition="flip">消息中心</a></li>
			<li data-role="list-divider">操作</li>
			<li data-theme="c"><a href="#page5" data-transition="flip">设置</a></li>
			<li data-theme="c"><a>注销</a></li>
		</ul>
	</div>
</div>



<!------------------------------------------------------状态发布---------------------------------------------------------->
<div data-role="page" id="pub" data-theme="c" data-add-back-btn="true">
	<div data-role="header" data-theme="c" data-position="fixed">
		<h1>发布状态</h1>
		<a data-icon="arrow-l" data-iconpos="notext" data-shadow="false" data-iconshadow="false" data-rel="back">Menu</a>
		<a data-role="button" data-rel="back" class="ui-btn-right" id="button-pub" onclick="sendMessage()">发布</a>
    </div>
	<div data-role="content" data-theme="c" style="padding:0">
		<!--------------分享功能-------------->
		<div class="jiathis_style_32x32" id="jiathis">
			<div class="count-word">
				<div style="margin-left:8px;float:left;">景点盖章</div>
				<p style="margin-right:8px;float:right;"><span id="length1">0</span>/140</p>
			</div>
			<div id="jiathis2">
				<div style="margin:0 auto;width:180px;height:32px;">
					<p style="padding-top:12px;padding-bottom:10px;">分享到...</p>
					<a class="jiathis_button_tsina"></a>
					<a class="jiathis_button_tqq"></a>
					<a class="jiathis_button_douban"></a>
					<a class="jiathis_button_renren"></a>
					<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
				</div>
				<a class="bshareDiv" href="http://www.bshare.cn/share">分享</a>
			</div>
		</div>
		
		
		<!----------------输入栏------------------>
		<div class="input">
			<form name="myform" id="myform1" style="height:100%">
				<textarea autofocus="true" id="message" placeholder="想说点什么？" onKeyDown="MaxInput1(this.form)" onKeyUp="MaxInput1(this.form)"></textarea>
			</form>
		</div>	
	</div>
</div>



<!------------------------------------------------------照片发布---------------------------------------------------------->
<div data-role="page" id="photo" data-theme="C" data-add-back-btn="true">
	<div data-role="header" data-theme="c" data-position="fixed">
		<h1>发布照片</h1>
		<a data-icon="arrow-l" data-iconpos="notext" data-shadow="false" data-iconshadow="false" data-rel="back">Menu</a>
		<a data-role="button" data-rel="back" class="ui-btn-right" id="button-pub" onclick="sendMessage2()">发布</a>
    </div>
	<div data-role="content" data-theme="c" style="padding:0">
		<!----------------输入栏------------------>
		<div class="input">
			<form name="myform" id="myform2" style="height:100%">
				<textarea autofocus="true" id="message2" placeholder="想说点什么？" onKeyDown="MaxInput2(this.form)" onKeyUp="MaxInput2(this.form)"></textarea>
				
			</form>
			<div class="count-word">
				<div style="margin-left:8px;float:left;">景点盖章</div>
				<p style="margin-right:8px;float:right;"><span id="length2">0</span>/140</p>
			</div>
			<img id="immediatePhoto" src=""/>
		</div>	
	</div>
</div>



<!----------------------------------------------------好友/驴友主页------------------------------------------------------->
<div data-role="page" id="zone-others" data-theme="c">
	<div data-role="header" data-theme="c" data-position="fixed">
		<h1>个人主页</h1>
		<a href="#zone-others-panel" data-icon="bars" data-iconpos="notext" data-shadow="false" data-iconshadow="false">Menu</a>
    </div>
	<div data-role="content" data-theme="c" style="padding:0">
		<div class="zone-header" id="2">
			<!---------------------用户头像----------------------->
			<div class="zone-avatar">
				<img src="img/Avatar.jpg"/>
			</div>
			
			<!---------------------用户信息----------------------->
			<div class="zone-userinfo">
				<div class="zone-username"><p>王大明</p></div>
				<div class="zone-gender"><img src="img/male-symbol.png"/></div>
				<div class="zone-eyeon">
					<a class="eyeon" href="#" data-role="button" data-theme="e" data-icon="plus" data-inline="true" data-mini="true">加关注</a>
				</div>
			</div>
		</div>
		<div class="zone-container" id="">
		</div>
	</div>
	
	<!---------------------好友主页panel--------------------->
	<div data-role="panel" id="zone-others-panel" data-theme="b" data-position-fixed="true">
		<ul data-role="listview" data-divider-theme="b" data-inset="false">
			<li data-theme="a" id="panelHead"><img id="panelHeadImg" src="img/Avatar.jpg" height="100%">王小明</li>
			<li data-theme="c"><a href="#page0" data-transition="flip" >首页</a></li>
			<li data-theme="c"><a href="#page1" >景区地图</a></li>
			<li data-role="list-divider" >动态</li>
			<li data-theme="c"><a href="#page2" data-transition="flip" onclick="initialFriendStatus()">好友动态</a></li>
			<li data-theme="c"><a href="#page3" data-transition="flip" onclick="initialQueryJDNews()">景区新鲜事</a></li>
			<li data-role="list-divider">关于我</li>
			<li data-theme="c"><a href="#page4" data-transition="flip" onclick="initialQueryPersonNews()">个人主页</a></li>
			<li data-theme="c"><a href="#msg-reply" data-transition="flip">消息中心</a></li>
			<li data-theme="c"><a href="#page5" data-transition="flip">设置</a></li>
		</ul>
	</div>
</div>



<!------------------------------------------------------状态回复----------------------------------------------------------->
<div data-role="page" id="status">
	<div data-role="header" data-theme="c" data-position="fixed" data-tap-toggle="false">
		<h1>状态回复</h1>
		<a data-icon="arrow-l" data-iconpos="notext" data-shadow="false" data-iconshadow="false" data-rel="back">Menu</a>
    </div>
	<div data-role="content" data-theme="c">
		<table cellspacing="0" cellpadding="3" border="0" width="100%">
			<tbody id="status-reply" style="border-bottom:5px solid #FF0000;">
				<tr>
					<td width="100px"><img src="img/Avatar.jpg" /></td>
					<td>Name</td>
				</tr>
				<tr>
					<td></td>
					<td><img src="img/Avatar.jpg" /></td>
				</tr>
				<tr>
					<td></td>
					<td>Content<a><img width="20px" height="20px" src="reply.png" style="float:right"/></a></td>
				</tr>
				<tr>
					<td></td>
					<td id=${Id}><div id=${Reply_id}><img src="img/Avatar.jpg" width="30px" height="30px"/>Name 回复Target_Name: Content<a class="button-reply" ><img width="20px" height="20px" src="img/reply.png" style="float:right"/></a></div></td>
				</tr>

			</tbody>
		</table>
	</div>
	<div data-role="footer" data-theme="c" data-position="fixed" data-tap-toggle="false">
		<div style="width:93%;margin-left:1%;"><input type="text" name="" id="" value="" data-mini="true" /></div>
		<a data-role="button" data-rel="back" class="ui-btn-right" style="margin-top:1px;margin-right:1%">发布</a>
	</div>
</div>






<!--------------------------------------------------消息中心-回复评论------------------------------------------------------>
<div  data-role="page" id="msg-reply" data-theme="c">
	<div data-role="header" data-theme="c" data-position="fixed">
		<h1>消息中心</h1>
		<a href="#msg-reply-panel" data-icon="bars" data-iconpos="notext" data-shadow="false" data-iconshadow="false">Menu</a>
    </div>
	<div data-role="content" data-theme="c" style="padding:0">
		
	</div>
	<div data-role="footer" data-theme="c" data-position="fixed">	
		<div data-role="navbar">
			<ul>
				<li><a href="#" class="ui-btn-active ui-state-persist">评论回复</a></li>
				<li><a href="#msg-newf">新的朋友</a></li>
			</ul>
		</div>
	</div>
	<div data-role="panel" id="msg-reply-panel" data-theme="b" data-position-fixed="true">
		<ul data-role="listview" data-divider-theme="b" data-inset="false">
			<li data-theme="a"><img src="img/Avatar.jpg" height="100%">王小明</li>
			<li data-theme="c"><a href="#page0" data-transition="flip">首页</a></li>
			<li data-theme="c"><a href="#page1" data-transition="filp">景区地图</a></li>
			<li data-role="list-divider" >动态</li>
			<li data-theme="c"><a href="#page2" data-transition="flip" onclick="initialQueryPersonNews()">好友动态</a></li>
			<li data-theme="c"><a href="#page3" data-transition="flip" onclick="initialQueryJDNews()">景区新鲜事</a></li>
			<li data-role="list-divider">关于我</li>
			<li data-theme="c"><a href="#page4" data-transition="flip" onclick="initialQueryPersonNews()">个人主页</a></li>
			<li data-theme="c"><a href="#msg-reply-panel" data-transition="flip">消息中心</a></li>
			<li data-role="list-divider">操作</li>
			<li data-theme="c"><a href="#page5" data-transition="flip">设置</a></li>
			<li data-theme="c"><a>注销</a></li>
		</ul>
	</div>
</div>



<!--------------------------------------------------消息中心-新的朋友------------------------------------------------------>
<div  data-role="page" id="msg-newf" data-theme="c">
	<div data-role="header" data-theme="c" data-position="fixed">
		<h1>消息中心</h1>
		<a href="#msg-newf-panel" data-icon="bars" data-iconpos="notext" data-shadow="false" data-iconshadow="false">Menu</a>
    </div>
	
	<!-----------------------------消息列表------------------------------->
	<div data-role="content" data-theme="c">
		<ul data-role="listview" id="newf-list">
			<li id="2-newf">
				<a href="#zone-others">
					<img src="img/Avatar.jpg"/>
					<h3>王小明</h3><p>请求加您为好友</p>
				</a>
				<div class="ui-li-aside">
					<button class="newfY" data-inline="true">同意</button>
					<button class="newfN" data-inline="true">拒绝</button>
				</div>
			</li>
			<li>
				<a href="#zone-others">
					<img src="img/Avatar.jpg"/>
					<h3>王小明</h3><p>请求加您为好友</p>
				</a>
				<div class="ui-li-aside">
					<button data-inline="true">已添加</button>
				</div>
			</li>
			<li>
				<a href="#zone-others">
					<img src="img/Avatar.jpg"/>
					<h3>王小明</h3><p>请求加您为好友</p>
				</a>
				<div class="ui-li-aside">
					<button data-inline="true" onclick="aaa();">已拒绝</button>
				</div>
			</li>
			<li>
				<a href="#zone-others">
					<img src="img/Avatar.jpg"/>
					<h3>王小明</h3><p>已添加您为好友</p>
				</a>
			</li>
		</ul>
	</div>
	<div data-role="footer" data-theme="c" data-position="fixed" >	
		<div data-role="navbar">
			<ul>
				<li><a href="#msg-reply">评论回复</a></li>
				<li><a href="#" class="ui-btn-active ui-state-persist">新的朋友</a></li>
			</ul>
		</div>
	</div>
	
	<!---------------------------------新的朋友panel----------------------------------->
	<div data-role="panel" id="msg-newf-panel" data-theme="b" data-position-fixed="true">
		<ul data-role="listview" data-divider-theme="b" data-inset="false">
			<li data-theme="a"><img src="img/Avatar.jpg" height="100%">王小明</li>
			<li data-theme="c"><a href="#page0" data-transition="flip">首页</a></li>
			<li data-theme="c"><a href="#page1" data-transition="filp">景区地图</a></li>
			<li data-role="list-divider" >动态</li>
			<li data-theme="c"><a href="#page2" data-transition="flip" onclick="initialFriendStatus()">好友动态</a></li>
			<li data-theme="c"><a href="#page3" data-transition="flip" onclick="initialQueryJDNews()">景区新鲜事</a></li>
			<li data-role="list-divider">关于我</li>
			<li data-theme="c"><a href="#page4" data-transition="flip" onclick="initialQueryPersonNews()">个人主页</a></li>
			<li data-theme="c"><a href="#msg-newf-panel" data-transition="flip">消息中心</a></li>
			<li data-role="list-divider">操作</li>
			<li data-theme="c"><a href="#page5" data-transition="flip">设置</a></li>
			<li data-theme="c"><a>注销</a></li>
		</ul>
	</div>
</div>



<!-------------------------------------------------------好友动态---------------------------------------------------------->
<div data-role="page" id="page2" data-theme="c" >
    <div data-role="header" data-theme="c" data-position="fixed" data-tap-toggle="false">
      <h1>好友动态</h1>
      <a href="#panel2" data-icon="bars" data-iconpos="notext" data-shadow="false" data-iconshadow="false">Menu</a>
	  <button type="button" id="friendRefresh" data-icon="refresh">刷新</button>
	</div>
    <div data-role="content" style="padding: 0%">
      <table cellspacing="0" cellpadding="3" border="0" width="100%">
        <tbody id="friend-new" style="border-bottom:5px solid #FF0000;">
        </tbody>
      </table>
      <button type="button" id="friendLoadMore">点击加载更多</button>
    </div>
    <!--div data-role="popup" id="popupReply" data-theme="c" class="ui-corner-all">
				<div style="padding:10px 20px;">
				  <h3>请输入回复内容</h3>
		          <label for="un" class="ui-hidden-accessible">Comment:</label>
		          <input type="text" name="comment" id="reply-content-friend" value="" placeholder="回复内容" data-theme="a" />
				  <button data-theme="b" id="button-send-friend">发送</button>
				</div>
		</div-->
	<div data-role="footer" data-theme="c" data-position="fixed" data-tap-toggle="false" id="page2-reply"style="display:none">
		<div style="width:88%;margin-left:1%;"><input type="text" id="reply-content" value="" data-mini="true" /></div>
		<a id="button-send-friend" data-role="button" class="ui-btn-right" style="margin-top:1px;margin-right:1%;width:8%">发布</a>
	</div>
    <div data-role="panel" id="panel2" data-position="left" data-display="push" data-theme="b" data-position-fixed="true">
		<ul data-role="listview" data-divider-theme="b" data-inset="false">
			<li data-theme="a"><img src="img/Avatar.jpg" height="100%">王小明</li>
			<li data-theme="c"><a href="#page0" data-transition="flip">首页</a></li>
			<li data-theme="c"><a href="#page1" data-transition="filp">景区地图</a></li>
			<li data-role="list-divider" >动态</li>
			<li data-theme="c"><a href="#panel2" data-transition="flip" onclick="initialFriendStatus()">好友动态</a></li>
			<li data-theme="c"><a href="#page3" data-transition="flip" onclick="initialQueryJDNews()">景区新鲜事</a></li>
			<li data-role="list-divider">关于我</li>
			<li data-theme="c"><a href="#page4" data-transition="flip" onclick="initialQueryPersonNews()">个人主页</a></li>
			<li data-theme="c"><a href="#msg-reply" data-transition="flip">消息中心</a></li>
			<li data-role="list-divider">操作</li>
			<li data-theme="c"><a href="#page5" data-transition="flip">设置</a></li>
			<li data-theme="c"><a>注销</a></li>
		</ul>
    </div>
</div>



<!------------------------------------------------------景区新鲜事--------------------------------------------------------->
<div data-role="page" id="page3" data-theme="c" >
    <div data-role="header" data-theme="c">
      <h1>景区新鲜事</h1>
      <a href="#panel3" data-icon="bars" data-iconpos="notext" data-shadow="false" data-iconshadow="false">Menu</a>
	  <button type="button" id="spotRefresh" data-icon="refresh">刷新</button>
	</div>
    <div data-role="content" style="padding: 0%">
      <table cellspacing="0" cellpadding="3" border="0" width="100%">
        <tbody id="spot-new">
        </tbody>
      </table>
      <button type="button" id="spotLoadMore">点击加载更多</button>
    </div>
	<div data-role="panel" id="panel3" data-position="left" data-theme="b" data-position-fixed="true">
		<ul data-role="listview" data-divider-theme="b" data-inset="false">
			<li data-theme="a"><img src="img/Avatar.jpg" height="100%">王小明</li>
			<li data-theme="c"><a href="#page0" data-transition="flip">首页</a></li>
			<li data-theme="c"><a href="#page1" data-transition="filp">景区地图</a></li>
			<li data-role="list-divider" >动态</li>
			<li data-theme="c"><a href="#page2" data-transition="flip" onclick="initialFriendStatus()">好友动态</a></li>
			<li data-theme="c"><a href="#panel3" data-transition="flip" onclick="initialQueryJDNews()">景区新鲜事</a></li>
			<li data-role="list-divider">关于我</li>
			<li data-theme="c"><a href="#page4" data-transition="flip" onclick="initialQueryPersonNews()">个人主页</a></li>
			<li data-theme="c"><a href="#msg-reply" data-transition="flip">消息中心</a></li>
			<li data-role="list-divider">操作</li>
			<li data-theme="c"><a href="#page5" data-transition="flip">设置</a></li>
			<li data-theme="c"><a>注销</a></li>
		</ul>
	</div>
</div>



<!--------------------------------------------------个人主页-------------------------------------------------------->
<div data-role="page" id="page4" data-theme="c" >
<div data-role="header" data-theme="c">
  <h1>个人主页</h1>
  <a href="#panel4" data-icon="bars" data-iconpos="notext" data-shadow="false" data-iconshadow="false">Menu</a>
  <button type="button" id="myStatusRefresh" data-icon="refresh">刷新</button>
</div>
<div data-role="content" style="padding: 0%">
  <table cellspacing="0" cellpadding="3" border="0" width="100%">
	<tbody id="personal-new">
	</tbody>
  </table>
  <button type="button" id="myStatusLoadMore">点击加载更多</button>
</div>
	<!--div data-role="popup" id="popupReply" data-theme="c" class="ui-corner-all">
			<div style="padding:10px 20px;">
			  <h3>请输入回复内容</h3>
			  <label for="un" class="ui-hidden-accessible">Comment:</label>
			  <input type="text" name="comment" id="reply-content-personal" value="" placeholder="回复内容" data-theme="a" />
			  <button data-theme="b" id="button-send-personal">发送</button>
			</div>
	</div-->
	<div data-role="panel" id="panel4" data-position="left" data-theme="b" data-position-fixed="true">
		<ul data-role="listview" data-divider-theme="b" data-inset="false">
			<li data-theme="a"><img src="img/Avatar.jpg" height="100%">王小明</li>
			<li data-theme="c"><a href="#page0" data-transition="flip">首页</a></li>
			<li data-theme="c"><a href="#page1" data-transition="filp">景区地图</a></li>
			<li data-role="list-divider" >动态</li>
			<li data-theme="c"><a href="#page2" data-transition="flip" onclick="initialFriendStatus()">好友动态</a></li>
			<li data-theme="c"><a href="#page3" data-transition="flip" onclick="initialQueryJDNews()">景区新鲜事</a></li>
			<li data-role="list-divider">关于我</li>
			<li data-theme="c"><a href="#panel4" data-transition="flip" onclick="initialQueryPersonNews()">个人主页</a></li>
			<li data-theme="c"><a href="#msg-reply" data-transition="flip">消息中心</a></li>
			<li data-role="list-divider">操作</li>
			<li data-theme="c"><a href="#page5" data-transition="flip">设置</a></li>
			<li data-theme="c"><a>注销</a></li>
		</ul>
	</div>
</div>



<!------------------------------------------------------设置---------------------------------------------------------->
<div data-role="page" id="page5" data-theme="c" >
	<div data-role="header" data-theme="c">
	  <h1>设置</h1>
	  <a href="#panel5" data-icon="bars" data-iconpos="notext" data-shadow="false" data-iconshadow="false">Menu</a>
	</div>
	<div data-role="content" style="padding: 0%">
	   
	</div>
	<div data-role="panel" id="panel5" data-theme="b" data-position-fixed="true">
	   <ul data-role="listview" data-divider-theme="b" data-inset="false">
			<li data-theme="a"><img src="img/Avatar.jpg" height="100%">王小明</li>
			<li data-theme="c"><a href="#page0" data-transition="flip">首页</a></li>
			<li data-theme="c"><a href="#page1" data-transition="filp">景区地图</a></li>
			<li data-role="list-divider" >动态</li>
			<li data-theme="c"><a href="#page2" data-transition="flip" onclick="initialFriendStatus()">好友动态</a></li>
			<li data-theme="c"><a href="#page3" data-transition="flip" onclick="initialQueryJDNews()">景区新鲜事</a></li>
			<li data-role="list-divider">关于我</li>
			<li data-theme="c"><a href="#page4" data-transition="flip" onclick="initialQueryPersonNews()">个人主页</a></li>
			<li data-theme="c"><a href="#msg-reply" data-transition="flip">消息中心</a></li>
			<li data-role="list-divider">操作</li>
			<li data-theme="c"><a href="#panel5" data-transition="flip">设置</a></li>
			<li data-theme="c"><a>注销</a></li>
	  </ul>
	</div>
</div>
<!---------------------------------------------------------景点介绍-------------------------------------------------------->
<div data-role="page" id="introduce" data-theme="c">
	<div data-role="header">
		<h1>详细信息</h1>
		<a data-rel="back" data-theme="c" >返回</a>
		<div data-role="navbar">
			<ul>
				<li><a href="#" class="ui-btn-active ui-state-persist">介绍</a></li>
				<li><a href="#comment" id="toComment">评价</a></li>
			</ul>
		</div>

	</div>
	<div data-role="content">
	<div id="intro"></div>
		<img id="spot_head" style="float:left;" src="" width="100px" height="100px"  />
		<div id="abc" style="position:relative; margin-left:250px; height:100px; "> 
		<button data-inline="true" data-icon="plus" data-theme="e" >加关注</button>
		<p id="spot_name" style="font-family:微软雅黑; margin-left: 15px;"></p>
		</div>
		<hr>
		<br><br>
		<!--<img id="spot_pic" src="" width="400px" height="300px" align="bottom"/>-->
	<div id="main" role="main">
      <section class="slider">
        <div class="flexslider">
		<div class="flex-viewport" style="overflow:hidden;position:relative;">
          <ul class="slides">
            <li>
  	    	    <img src = "img/1.jpg" id = "introducepic" onclick = "swipeToChangPic()" draggable = "false" >	
  	    		</li>
          </ul>
        </div>
		</div>
      </section>
    </div>
	
		<p id="spot_intro"></p>
 
		<hr>
		<center>
			<p>景点新鲜事</p>
		</center>
		<table cellspacing="0" cellpadding="3" border="0" width="100%">
		<tbody id="newthings"></tbody>
		</table>
	</div>

</div><!-- /page -->
<div data-role="page" id="comment" data-theme="c">
	<div data-role="header">
		<h1>详细信息</h1>
		<a data-rel="back" data-theme="c" >返回</a>
		<button type="button" id="commentRefresh" data-icon="refresh">刷新</button>
		<div data-role="navbar">
			<ul>
				<li><a href="#introduce">介绍</a></li>
				<li><a href="#" class="ui-btn-active ui-state-persist">评价</a></li>
			</ul>
		</div>
	</div>
	<div data-role="content">

	<p style="float:left;">发表评论~</p>
	<p class="starWrapper" onmouseover="rate(this,event)"> 
		<img src="" title="很烂" />
		<img src="" title="一般" />
		<img src="" title="还好" />
		<img src="" title="较好" />
		<img src="" title="很好" /> 
	<textarea name="textarea" id="textarea"></textarea>
	</div>

	<center>
	<button type="button" data-inline="true" data-theme="e" onClick="ensure()">确定</button>
	</center>	
	<hr>
		<table cellspacing="0" cellpadding="3" border="0" width="100%">
			<tbody id="comments"></tbody>
		</table>
		<button type="button" id="commentLoadMore">点击加载更多</button>

	

	</div>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1373077207876240" charset="utf-8"></script>
<script type="text/javascript" charset="utf-8" src="http://static.bshare.cn/b/buttonLite.js#uuid=<>&style=-1"></script>
<script type="text/javascript" charset="utf-8" src="http://static.bshare.cn/b/addons/bshareAp.js"></script>
</body>
</html>
